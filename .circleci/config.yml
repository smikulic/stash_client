version: 2
jobs:
  build:
    working_directory: ~/stash_client
    docker:
      - image: circleci/node:8.1.4
    steps:
      - checkout
      - run:
          name: Step - Yarn Install
          command: yarn install
      - run:
          name: Step - Build Production
          command: yarn build:production
      - run:
          name: Step - Lint
          command: yarn lint
      - run:
          name: Step - Test
          command: yarn test
  build-test-and-deploy:
    steps:
      - run:
          name: Step - Build Production
          command: echo "Hello, world!"

workflows:
  version: 2
  build-and-test:
    jobs:
      - build
  build-test-and-deploy:
    jobs:
      - build-test-and-deploy
        filters:
          tags:
            only: /^release-.*/
        
  # deployment:
  #   release:
  #     tag: /release-.*/
  #     steps:
  #       - run:
  #           name: Step - Build Production
  #           command: yarn build:production
  #       - run:
  #           name: Step - Copy Production Build To Server
  #           command: scp -r dist/* $DO_USER@$DO_IP:/var/www/scroogevault.co/dist/
